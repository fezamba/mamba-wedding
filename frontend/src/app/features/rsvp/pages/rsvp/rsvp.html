<div class="main-wrapper">
  
  <div class="polaroid p1 floating" (click)="openPhoto('assets/foto-casal-1.jpg')">
    <img src="assets/foto-casal-1.jpg" alt="N√≥s dois" />
  </div>
  <div class="polaroid p2 floating-delayed" (click)="openPhoto('assets/foto-casal-2.jpg')">
    <img src="assets/foto-casal-2.jpg" alt="Love" />
  </div>

  <div class="lightbox-overlay fade-in" *ngIf="expandedPhoto()" (click)="closePhoto()">
    <div class="lightbox-content">
      <img [src]="expandedPhoto()" alt="Foto expandida" />
      <span class="close-hint">Toque em qualquer lugar para fechar</span>
    </div>
  </div>

  <div class="rsvp-card">
    <header class="card-header">
      <div class="icon">üíç</div>
      <h1>Mamba Wedding</h1>
      <p class="subtitle">Confirme sua presen√ßa neste momento especial</p>
    </header>

    <section *ngIf="!guestData() && !successMessage()" class="step-section fade-in">
      <form [formGroup]="lookupForm" (ngSubmit)="onLookup()">
        <label for="code">C√≥digo do Convite</label>
        <div class="input-group">
          <input 
            id="code" 
            type="text" 
            formControlName="codigoConvite" 
            placeholder="Ex: MAMBA-2026" 
            autocomplete="off"
          />
          <button type="submit" [disabled]="lookupForm.invalid || isLoading()">
            <span *ngIf="!isLoading()">Buscar</span>
            <span *ngIf="isLoading()" class="loader"></span>
          </button>
        </div>
        <p class="hint">O c√≥digo est√° no seu convite individual.</p>
      </form>
      
      <div class="error-msg fade-in" *ngIf="errorMessage()">
        {{ errorMessage() }}
      </div>
    </section>

    <section *ngIf="guestData() && !successMessage()" class="step-section fade-in">
      
      <button class="btn-back-text" (click)="resetSearch()">
        ‚Üê Voltar / Trocar C√≥digo
      </button>

      <div class="guest-info">
        <h2>Ol√°, {{ guestData()?.nomeCompleto }}!</h2>
        <span class="status-badge" [class]="guestData()?.statusConvite">
          {{ guestData()?.statusConvite }}
        </span>
      </div>

      <form [formGroup]="actionForm" class="details-form">
        <div class="form-row">
          <div class="form-group">
            <label>Email</label>
            <input type="email" formControlName="email" placeholder="seu@email.com" />
          </div>
          <div class="form-group">
            <label>WhatsApp</label>
            <input type="tel" formControlName="telefone" placeholder="(XX) 9XXXX-XXXX" />
          </div>
        </div>

        <div class="form-group">
          <label>Observa√ß√µes (alergias, restri√ß√µes, etc.)</label>
          <textarea formControlName="observacoes" placeholder="Alguma restri√ß√£o alimentar? Ou apenas deixe seu carinho!"></textarea>
        </div>

        <div class="actions">
          <button type="button" (click)="submitRsvp(true)" class="btn-confirm" [disabled]="isLoading()">
            Confirmar Presen√ßa ‚ú®
          </button>
          <button type="button" (click)="submitRsvp(false)" class="btn-decline" [disabled]="isLoading()">
            N√£o poderei ir üíî
          </button>
        </div>
      </form>
    </section>

    <section *ngIf="successMessage()" class="success-section fade-in">
      <div class="success-icon">üíå</div>
      <h3>Obrigado!</h3>
      <p>{{ successMessage() }}</p>
      <button class="btn-outline" (click)="resetSearch()">
        Voltar ao in√≠cio
      </button>
    </section>
  </div>
</div>